<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Precificação - EngMarq Solution</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Open+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="./gerador-styles.css">
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-logo">
            <img src="./assets/logoengmarq.png" alt="EngMarq">
            <div>
                <h1>Calculadora de Precificação</h1>
                <span>Sistema de cálculo baseado no padrão EngMarq: 40% Custo | 60% Lucro</span>
            </div>
        </div>
        <div class="header-user">
            <a href="./index.html" class="btn-logout" style="margin-right: 10px;">
                <i class="fas fa-file-alt"></i> Propostas
            </a>
            <a href="./recibo.html" class="btn-logout" style="margin-right: 10px;">
                <i class="fas fa-receipt"></i> Recibos
            </a>
            <span id="userName"><i class="fas fa-user-circle"></i> <span id="userNameText"></span></span>
            <button class="btn-logout" onclick="fazerLogout()" title="Sair">
                <i class="fas fa-sign-out-alt"></i> Sair
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <div class="calculator-grid">
                <!-- Coluna Esquerda - Inputs -->
                <div class="inputs-column">
                    
                    <!-- Bloco: Valor do Vendedor -->
                    <section class="card card-vendedor">
                        <div class="card-header">
                            <div class="card-icon green">
                                <i class="fas fa-hand-holding-usd"></i>
                            </div>
                            <h2>Valor do Vendedor</h2>
                        </div>
                        <div class="card-body">
                            <div class="input-row single">
                                <div class="input-group">
                                    <label for="valorVendedor">Preço que pretende cobrar</label>
                                    <input type="text" id="valorVendedor" class="currency" placeholder="R$ 0,00">
                                </div>
                            </div>
                            <div class="comparacao-vendedor" id="comparacaoVendedor">
                                <div class="comparacao-item">
                                    <span>Diferença do Ideal:</span>
                                    <span id="diferencaIdeal" class="diff-value">R$ 0,00</span>
                                </div>
                                <div class="comparacao-item">
                                    <span>Margem com este valor:</span>
                                    <span id="margemVendedor" class="diff-value">0%</span>
                                </div>
                                <div class="comparacao-status hidden" id="statusVendedor">
                                    <i class="fas fa-check-circle"></i>
                                    <span>Dentro do padrão EngMarq</span>
                                </div>
                                <div class="comparacao-status danger hidden" id="statusVendedorDanger">
                                    <i class="fas fa-times-circle"></i>
                                    <span>Abaixo do padrão EngMarq</span>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Bloco: Custos Técnicos -->
                    <section class="card">
                        <div class="card-header">
                            <div class="card-icon blue">
                                <i class="fas fa-hard-hat"></i>
                            </div>
                            <h2>Custos Técnicos</h2>
                        </div>
                        <div class="card-body">
                            <div class="input-row">
                                <div class="input-group">
                                    <label for="horasTecnico">Horas Técnico de Segurança</label>
                                    <input type="number" id="horasTecnico" placeholder="0" min="0" step="0.5">
                                </div>
                                <div class="input-group">
                                    <label for="valorHoraTecnico">Valor hora Técnico</label>
                                    <input type="text" id="valorHoraTecnico" class="currency" placeholder="R$ 0,00">
                                </div>
                            </div>
                            <div class="input-row">
                                <div class="input-group">
                                    <label for="horasEngenheiro">Horas Engenheiro</label>
                                    <input type="number" id="horasEngenheiro" placeholder="0" min="0" step="0.5">
                                </div>
                                <div class="input-group">
                                    <label for="valorHoraEngenheiro">Valor hora Engenheiro</label>
                                    <input type="text" id="valorHoraEngenheiro" class="currency" placeholder="R$ 0,00">
                                </div>
                            </div>
                            <div class="input-row">
                                <div class="input-group">
                                    <label for="qtdVisitas">Quantidade de Visitas</label>
                                    <input type="number" id="qtdVisitas" placeholder="0" min="0">
                                </div>
                                <div class="input-group">
                                    <label for="valorVisita">Valor por Visita</label>
                                    <input type="text" id="valorVisita" class="currency" placeholder="R$ 0,00">
                                </div>
                            </div>
                            <div class="input-row">
                                <div class="input-group">
                                    <label for="valorPGR">Valor PGR</label>
                                    <input type="text" id="valorPGR" class="currency" placeholder="R$ 0,00">
                                </div>
                                <div class="input-group">
                                    <label for="valorPCMSO">Valor PCMSO</label>
                                    <input type="text" id="valorPCMSO" class="currency" placeholder="R$ 0,00">
                                </div>
                            </div>
                            <div class="input-row">
                                <div class="input-group">
                                    <label for="valorLTCAT">Valor LTCAT</label>
                                    <input type="text" id="valorLTCAT" class="currency" placeholder="R$ 0,00">
                                </div>
                                <div class="input-group">
                                    <label for="valorGestaoNR01">Gestão NR-01</label>
                                    <input type="text" id="valorGestaoNR01" class="currency" placeholder="R$ 0,00">
                                </div>
                            </div>
                            <div class="input-row">
                                <div class="input-group">
                                    <label for="valorTreinamentos">Treinamentos</label>
                                    <input type="text" id="valorTreinamentos" class="currency" placeholder="R$ 0,00">
                                </div>
                                <div class="input-group">
                                    <label for="valorAcompanhamento">Acompanhamento Mensal</label>
                                    <input type="text" id="valorAcompanhamento" class="currency" placeholder="R$ 0,00">
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Bloco: Custos Operacionais -->
                    <section class="card">
                        <div class="card-header">
                            <div class="card-icon orange">
                                <i class="fas fa-truck"></i>
                            </div>
                            <h2>Custos Operacionais</h2>
                        </div>
                        <div class="card-body">
                            <div class="input-row">
                                <div class="input-group">
                                    <label for="valorDeslocamento">Deslocamento</label>
                                    <input type="text" id="valorDeslocamento" class="currency" placeholder="R$ 0,00">
                                </div>
                                <div class="input-group">
                                    <label for="valorAlimentacao">Alimentação</label>
                                    <input type="text" id="valorAlimentacao" class="currency" placeholder="R$ 0,00">
                                </div>
                            </div>
                            <div class="input-row">
                                <div class="input-group">
                                    <label for="valorMateriais">Materiais</label>
                                    <input type="text" id="valorMateriais" class="currency" placeholder="R$ 0,00">
                                </div>
                                <div class="input-group">
                                    <label for="valorTaxas">Taxas</label>
                                    <input type="text" id="valorTaxas" class="currency" placeholder="R$ 0,00">
                                </div>
                            </div>
                            <div class="input-row single">
                                <div class="input-group">
                                    <label for="valorOutros">Outros Custos</label>
                                    <input type="text" id="valorOutros" class="currency" placeholder="R$ 0,00">
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Bloco: Impostos e Comissão -->
                    <section class="card">
                        <div class="card-header">
                            <div class="card-icon green">
                                <i class="fas fa-percent"></i>
                            </div>
                            <h2>Impostos e Comissão</h2>
                        </div>
                        <div class="card-body">
                            <div class="input-row">
                                <div class="input-group">
                                    <label for="issPercent">ISS %</label>
                                    <input type="number" id="issPercent" placeholder="0" min="0" max="100" step="0.1">
                                </div>
                                <div class="input-group">
                                    <label for="impostosPercent">Impostos Gerais %</label>
                                    <input type="number" id="impostosPercent" placeholder="0" min="0" max="100" step="0.1">
                                </div>
                            </div>
                            <div class="input-row single">
                                <div class="input-group">
                                    <label for="comissaoPercent">Comissão do Vendedor %</label>
                                    <input type="number" id="comissaoPercent" placeholder="0" min="0" max="100" step="0.1">
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Bloco: Desconto -->
                    <section class="card card-discount">
                        <div class="card-header">
                            <div class="card-icon purple">
                                <i class="fas fa-tag"></i>
                            </div>
                            <h2>Simulação de Desconto</h2>
                        </div>
                        <div class="card-body">
                            <div class="input-row single">
                                <div class="input-group">
                                    <label for="descontoPercent">Desconto Pretendido %</label>
                                    <input type="number" id="descontoPercent" placeholder="0" min="0" max="100" step="0.1">
                                </div>
                            </div>
                        </div>
                    </section>

                </div>

                <!-- Coluna Direita - Resultados -->
                <div class="results-column">
                    
                    <!-- Resultados Principais -->
                    <section class="card card-results sticky">
                        <div class="card-header">
                            <div class="card-icon gold">
                                <i class="fas fa-calculator"></i>
                            </div>
                            <h2>Resultados</h2>
                        </div>
                        <div class="card-body">
                            
                            <div class="result-item">
                                <span class="result-label">
                                    <i class="fas fa-coins"></i>
                                    Custo Total
                                </span>
                                <span class="result-value" id="resultCustoTotal">R$ 0,00</span>
                            </div>

                            <div class="result-item highlight">
                                <span class="result-label">
                                    <i class="fas fa-star"></i>
                                    Preço Ideal EngMarq
                                </span>
                                <span class="result-value large" id="resultPrecoIdeal">R$ 0,00</span>
                            </div>

                            <div class="result-item success">
                                <span class="result-label">
                                    <i class="fas fa-chart-line"></i>
                                    Lucro em R$
                                </span>
                                <span class="result-value" id="resultLucro">R$ 0,00</span>
                            </div>

                            <div class="result-item">
                                <span class="result-label">
                                    <i class="fas fa-percentage"></i>
                                    Margem %
                                </span>
                                <span class="result-value" id="resultMargem">0%</span>
                            </div>

                            <div class="result-divider"></div>

                            <div class="result-item warning">
                                <span class="result-label">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    Preço Mínimo Aceitável
                                </span>
                                <span class="result-value" id="resultPrecoMinimo">R$ 0,00</span>
                            </div>

                            <div class="result-item">
                                <span class="result-label">
                                    <i class="fas fa-user-tie"></i>
                                    Comissão do Vendedor
                                </span>
                                <span class="result-value" id="resultComissao">R$ 0,00</span>
                            </div>

                            <!-- Alerta de Margem (principal) -->
                            <div class="alert alert-danger hidden" id="alertMargemPrincipal">
                                <i class="fas fa-times-circle"></i>
                                <span>FORA DO PADRÃO ENGMARQ</span>
                                <small>A margem deve ser de no mínimo 60%</small>
                            </div>

                            <div class="alert alert-success hidden" id="alertMargemPrincipalOk">
                                <i class="fas fa-check-circle"></i>
                                <span>DENTRO DO PADRÃO ENGMARQ</span>
                                <small>Margem de lucro adequada</small>
                            </div>

                        </div>
                    </section>

                    <!-- Comparação com Valor do Vendedor -->
                    <section class="card card-vendedor-results hidden" id="cardVendedorResultados">
                        <div class="card-header">
                            <div class="card-icon green">
                                <i class="fas fa-balance-scale"></i>
                            </div>
                            <h2>Comparação: Seu Preço</h2>
                        </div>
                        <div class="card-body">
                            
                            <div class="result-item">
                                <span class="result-label">
                                    <i class="fas fa-hand-holding-usd"></i>
                                    Preço do Vendedor
                                </span>
                                <span class="result-value large" id="resultPrecoVendedor">R$ 0,00</span>
                            </div>

                            <div class="result-item" id="itemDiferenca">
                                <span class="result-label">
                                    <i class="fas fa-arrows-alt-h"></i>
                                    Diferença do Ideal
                                </span>
                                <span class="result-value" id="resultDiferencaIdeal">R$ 0,00</span>
                            </div>

                            <div class="result-item" id="itemLucroVendedor">
                                <span class="result-label">
                                    <i class="fas fa-chart-line"></i>
                                    Lucro com este Preço
                                </span>
                                <span class="result-value" id="resultLucroVendedor">R$ 0,00</span>
                            </div>

                            <div class="result-item" id="itemMargemVendedor">
                                <span class="result-label">
                                    <i class="fas fa-percentage"></i>
                                    Margem com este Preço
                                </span>
                                <span class="result-value" id="resultMargemVendedor">0%</span>
                            </div>

                            <!-- Alerta de Margem Vendedor -->
                            <div class="alert alert-danger hidden" id="alertVendedorDanger">
                                <i class="fas fa-times-circle"></i>
                                <span>FORA DO PADRÃO ENGMARQ</span>
                                <small>Este preço não atinge a margem de 60%</small>
                            </div>

                            <div class="alert alert-success hidden" id="alertVendedorOk">
                                <i class="fas fa-check-circle"></i>
                                <span>DENTRO DO PADRÃO ENGMARQ</span>
                                <small>Este preço mantém a margem adequada</small>
                            </div>

                        </div>
                    </section>

                    <!-- Resultados com Desconto -->
                    <section class="card card-discount-results hidden" id="cardDescontoResultados">
                        <div class="card-header">
                            <div class="card-icon purple">
                                <i class="fas fa-tag"></i>
                            </div>
                            <h2>Com Desconto de <span id="descontoLabel">0</span>%</h2>
                        </div>
                        <div class="card-body">
                            
                            <div class="result-item">
                                <span class="result-label">
                                    <i class="fas fa-receipt"></i>
                                    Preço com Desconto
                                </span>
                                <span class="result-value" id="resultPrecoDesconto">R$ 0,00</span>
                            </div>

                            <div class="result-item">
                                <span class="result-label">
                                    <i class="fas fa-percentage"></i>
                                    Nova Margem
                                </span>
                                <span class="result-value" id="resultNovaMargem">0%</span>
                            </div>

                            <div class="result-item">
                                <span class="result-label">
                                    <i class="fas fa-money-bill-wave"></i>
                                    Novo Lucro
                                </span>
                                <span class="result-value" id="resultNovoLucro">R$ 0,00</span>
                            </div>

                            <!-- Alerta de Margem -->
                            <div class="alert alert-danger hidden" id="alertMargem">
                                <i class="fas fa-times-circle"></i>
                                <span>FORA DO PADRÃO ENGMARQ</span>
                                <small>A margem deve ser de no mínimo 60%</small>
                            </div>

                            <div class="alert alert-success hidden" id="alertMargemOk">
                                <i class="fas fa-check-circle"></i>
                                <span>DENTRO DO PADRÃO ENGMARQ</span>
                                <small>Margem de lucro adequada</small>
                            </div>

                        </div>
                    </section>

                    <!-- Botões de Ação -->
                    <div class="action-buttons">
                        <button type="button" class="btn btn-secondary" id="btnLimpar">
                            <i class="fas fa-eraser"></i>
                            Limpar Tudo
                        </button>
                        <button type="button" class="btn btn-primary" id="btnGerarResumo">
                            <i class="fas fa-file-alt"></i>
                            Gerar Resumo
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </main>

    <!-- Modal Resumo -->
    <div class="modal-overlay hidden" id="modalResumo">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-file-alt"></i> Resumo da Precificação</h3>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body" id="modalContent">
                <!-- Conteúdo gerado via JS -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="btnCopiar">
                    <i class="fas fa-copy"></i> Copiar
                </button>
                <button class="btn btn-primary" id="btnImprimir">
                    <i class="fas fa-print"></i> Imprimir
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>EngMarq Solution &bull; Calculadora de Precificação &bull; 40% Custo | 60% Lucro</p>
        </div>
    </footer>

    <script type="module" src="./src/calculadora.ts"></script>
</body>
</html>
